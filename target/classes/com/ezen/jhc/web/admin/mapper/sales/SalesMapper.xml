<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ezen.jhc.web.admin.mapper.sales.SalesMapper">

	<select id="getDailySales" resultType="com.ezen.jhc.web.admin.dto.sales.DailySalesDTO">
		SELECT
        	s_ctgr_name,
        	m_ctgr_num,
        	count(sc.s_ctgr_name) as daily_sales,
        	sum(total_amount) as daily_amount
        	
    	FROM 
    		order_details od 
    	INNER JOIN 
    		orders ord ON ord.ord_num = od.ord_num 
    	INNER JOIN 
    		prod_details pd ON pd.pd_num = od.pd_num
    	INNER JOIN 
    		prods p ON p.p_num = pd.p_num
    	INNER JOIN 
    		sub_ctgr sc ON sc.s_ctgr_num = p.s_ctgr_num
    	WHERE ord_date = to_date(20230307)
    	GROUP BY s_ctgr_name, m_ctgr_num
    	ORDER BY m_ctgr_num
    	
	</select>

</mapper>

